{% extends 'base.html.twig' %}

{% block title %}DÃ©tail commande {{ commande.reference }}{% endblock %}

{% block body %}
    <h1>ðŸ“‹ DÃ©tail de la commande {{ commande.reference }}</h1>

    <p><strong>Utilisateur :</strong> 
        {{ commande.utilisateur ? commande.utilisateur.prenom ~ ' ' ~ commande.utilisateur.nom : 'Inconnu' }}
        ({{ commande.utilisateur ? commande.utilisateur.email : '' }})
    </p>

    <p><strong>Adresse de livraison :</strong>
        {% if commande.utilisateur %}
            {{ commande.utilisateur.adresse }},
            {{ commande.utilisateur.cp }} {{ commande.utilisateur.ville }}
        {% else %}
            Non renseignÃ©e
        {% endif %}
    </p>

    <table class="table table-bordered">
        <thead>
            <tr>
                <th>Produit</th>
                <th>QuantitÃ©</th>
                <th>Prix unitaire (â‚¬)</th>
                <th>Sous-total (â‚¬)</th>
            </tr>
        </thead>
        <tbody>
            {% set total = 0 %}
            {% for ligne in commande.ligneDeCommandes %}
                {% set sousTotal = ligne.quantiteCommande * ligne.prixUnitaireProduit %}
                {% set total = total + sousTotal %}

                <tr>
                    <td>{{ ligne.produit ? ligne.produit.nomproduit : 'Produit supprimÃ©' }}</td>
                    <td>{{ ligne.quantiteCommande }}</td>
                    <td>{{ ligne.prixUnitaireProduit }}</td>
                    <td>{{ sousTotal }}</td>
                </tr>
            {% else %}
                <tr>
                    <td colspan="4" class="text-center">Aucun produit dans cette commande</td>
                </tr>
            {% endfor %}
        </tbody>
        <tfoot>
            <tr>
                <th colspan="3" class="text-end">Total :</th>
                <th>{{ total }} â‚¬</th>
            </tr>
        </tfoot>
    </table>

    <a href="{{ path('admin_commandes') }}" class="btn btn-secondary">â¬… Retour Ã  la liste</a>
{% endblock %}
