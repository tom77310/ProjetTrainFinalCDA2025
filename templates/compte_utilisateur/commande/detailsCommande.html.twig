{% extends 'base.html.twig' %}

{% block title %}Détails de la commande{% endblock %}

{% block body %}
<div class="container mt-4">
    <h1>Détails de la commande n°{{ commande.id }}</h1>
    <p><strong>Référence :</strong> {{ commande.reference }}</p>
    <p><strong>Utilisateur :</strong> {{ commande.utilisateur.email }}</p>

    <h2>Produits commandés</h2>
    <table class="table table-striped">
        <thead>
            <tr>
                <th>Produit</th>
                <th>Quantité</th>
                <th>Prix unitaire</th>
                <th>Total</th>
            </tr>
        </thead>
        <tbody>
            {% for ligne in commande.ligneDeCommandes %}
                <tr>
                    <td>{{ ligne.produit.nomProduit }}</td>
                    <td>{{ ligne.quantiteCommande }}</td>
                    <td>{{ ligne.prixUnitaireProduit }} €</td>
                    <td>{{ ligne.quantiteCommande * ligne.prixUnitaireProduit }} €</td>
                </tr>
            {% else %}
                <tr>
                    <td colspan="4" class="text-center">Aucun produit dans cette commande.</td>
                </tr>
            {% endfor %}
        </tbody>
    </table>

    <h3 class="mt-3">
        Total de la commande :
        {{
            commande.ligneDeCommandes|reduce(
                (carry, ligne) => carry + (ligne.quantiteCommande * ligne.prixUnitaireProduit),
                0
            )
        }} €
    </h3>
</div>
{% endblock %}
